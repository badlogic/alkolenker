import { LitElement, PropertyValueMap, html } from "lit";
import { customElement, property, state } from "lit/decorators.js";
import { Api, PressRelease } from "../api.js";
import { renderError } from "../app.js";
import { pageContainerStyle, pageContentStyle } from "../utils/styles.js";
import { searchIcon } from "../utils/icons.js";
import { repeat } from "lit-html/directives/repeat.js";
import { unsafeHTML } from "lit-html/directives/unsafe-html.js";

const states = new Set<string>([
    "Steiermark",
    "Kärnten",
    "Tirol",
    "Vorarlberg",
    "Salzburg",
    "Oberösterreich",
    "Niederösterreich",
    "Wien",
    "Burgenland",
]);

@customElement("main-page")
export class MainPage extends LitElement {
    @property()
    isLoading = true;

    @property()
    error?: string;

    @state()
    releases: PressRelease[] = [];

    @state()
    foundReleases: PressRelease[] = [];

    query!: PreparedQuery;

    @state()
    selectedStates = new Set<string>(states);

    protected createRenderRoot(): Element | ShadowRoot {
        return this;
    }

    protected firstUpdated(_changedProperties: PropertyValueMap<any> | Map<PropertyKey, unknown>): void {
        super.firstUpdated(_changedProperties);
        this.load();
        setTimeout(() => this.handleQuery(), 200);
    }

    async load() {
        try {
            const result = await Api.releases();
            if (result instanceof Error) throw result;
            this.releases = result;
        } catch (e) {
            this.error = "Konnte Pressemitteilungen nicht laden";
            return;
        } finally {
            this.isLoading = false;
        }
    }

    render() {
        if (this.isLoading) return html`<loading-spinner></loading-spinner>`;
        if (this.error) return renderError(this.error);
        return html`<div class="${pageContainerStyle}">
            <div class="${pageContentStyle} mt-4 px-4 gap-4 text-center">
                <h1 class="text-center">Eines, zwei, Polizei</h1>
                <p class="text-sm">
                    Alle Pressemitteilungen der Landespolizeidirektionen Österreichs ab dem 12.6.2024 nach Stichworten durchsuchen. Stündlich
                    aktualisiert.
                </p>
                <p class="text-xs">
                    Bundesländer durch klick (de-)selektieren. Stichwörter werden im Titel und Text der Pressemitteilungen gesucht. Um ein Wort aus-
                    bzw. unbedingt einzuschließen, '-' oder '+' voransetzen. Z.B. '+Alkohol +Lenker' um nur Pressemitteilungen anzuzeigen, die beide
                    Worte beinhalten. Zur Suche ganzer Phrasen, die Phrase in Anführungszeichen setzen.
                </p>
                <div class="flex justify-center">${this.renderMap()}</div>
                <div class="flex gap-4 px-4 py-2 border border-[#777] dark:border-[#ccc] rounded-full bg-transparent">
                    <i class="icon w-6 h-6">${searchIcon}</i>
                    <input
                        class="flex-grow bg-transparent"
                        id="query"
                        value="alko"
                        placeholder="Alkohol Alkolenker alkoholisiert ..."
                        @input=${() => this.handleQuery()}
                        @keyup=${() => this.handleQuery()}
                    />
                </div>
                <span class="font-semibold text-left"
                    >${this.foundReleases.length == 0
                        ? "Keine Ergebnisse"
                        : this.foundReleases.length == 1
                        ? "1 Ergebnis"
                        : `${this.foundReleases.length} Ergebnisse`}</span
                >
                <div class="flex flex-col gap-4 text-left">
                    ${repeat(
                        this.foundReleases,
                        (item) => item.date + "-" + item.title + "-" + item.state,
                        (item) => {
                            let text = item.text.replaceAll("\n\n", "<br>");
                            text = this.highlight(text, [...Array.from(this.query.must.values()), ...Array.from(this.query.optional.values())]);
                            return html`<div class="flex flex-col gap-2 mb-4">
                                <a href="${item.url}" target="_blank" class="font-semibold text-blue-400">${item.title}</a>
                                <span class="text-sm font-semibold">${item.state} - ${item.date}</span>
                                <p>${unsafeHTML(text)}</p>
                            </div>`;
                        }
                    )}
                </div>
                <div class="flex flex-col text-xs text-center text-fg-muted pb-4 px-4 mt-8">
                    <span>Mit Spucke und Tixo gebaut von <a href="https://twitter.com/badlogicgames" class="text-blue-400">Mario Zechner</a></span>
                    <span>Es werden keine Daten gesammelt, nicht einmal deine IP Adresse</span>
                    <a href="https://github.com/badlogic/alkolenker" target="_blank" class="text-blue-400">Source Code</a>
                </div>
            </div>
        </div>`;
    }

    handleQuery() {
        this.foundReleases = this.releases.filter((release) => this.selectedStates.has(release.state));
        const queryText = this.querySelector<HTMLInputElement>("#query")?.value;
        this.query = prepareQuery(queryText ?? "alko");
        this.foundReleases = this.foundReleases.filter((release) => matchesQuery(this.query, release.text));
    }

    renderMap() {
        const handleStateClick = (ev: Event) => {
            const el = ev.target as HTMLElement;
            if (states.has(el.id)) {
                if (el.getAttribute("fill") == "#B1D1A3") {
                    console.log("Deselected " + el.id);
                    el.setAttribute("fill", "#B1D1A322");
                    this.selectedStates.delete(el.id);
                } else {
                    console.log("Selected " + el.id);
                    el.setAttribute("fill", "#B1D1A3");
                    this.selectedStates.add(el.id);
                }
                this.handleQuery();
            }
        };

        return html`<svg
            @click=${(ev: Event) => handleStateClick(ev)}
            xmlns:dc="http://purl.org/dc/elements/1.1/"
            xmlns:cc="http://web.resource.org/cc/"
            xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
            xmlns:svg="http://www.w3.org/2000/svg"
            xmlns:sodipodi="http://inkscape.sourceforge.net/DTD/sodipodi-0.dtd"
            xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
            xmlns="http://www.w3.org/2000/svg"
            xmlns:xlink="http://www.w3.org/1999/xlink"
            version="1.1"
            id="svg2"
            sodipodi:version="0.32"
            inkscape:version="0.43"
            sodipodi:docname="Ã¶sterreich_mit_bl.svg"
            sodipodi:docbase="C:Dokumente und EinstellungenAndreas GriessnerDesktopsvg Ã¶sterreichundeslÃ¤nder"
            x="0px"
            y="0px"
            class="max-w-[480px]"
            viewBox="0 0 1948.5 1066.5"
            enable-background="new 0 0 1948.5 1066.5"
            xml:space="preserve"
        >
            <sodipodi:namedview
                id="base"
                inkscape:window-width="1024"
                inkscape:pageshadow="2"
                inkscape:pageopacity="0.0"
                inkscape:window-y="-2"
                inkscape:window-x="-8"
                inkscape:window-height="719"
                inkscape:current-layer="svg2"
                inkscape:cy="405.76054"
                inkscape:cx="1143.2333"
                inkscape:zoom="0.4"
                borderopacity="1.0"
                bordercolor="#666666"
                pagecolor="#ffffff"
            >
            </sodipodi:namedview>
            <path
                id="Vorarlberg"
                sodipodi:nodetypes="cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc"
                fill="#B1D1A3"
                stroke="#284566"
                stroke-width="2"
                stroke-dasharray="9,9"
                d="  M185.875,905.437l0.498-15.42l-8.456-4.974l-0.995-11.938l8.953-6.964l3.979-9.451l-0.497-8.456l-2.487-9.451l0.995-4.477  l4.974-9.451l-1.492-8.456l2.487-7.461l6.964-10.445l5.472-10.943l1.989-10.445l-1.492-9.949l-3.979-10.442l-3.52-11.757  l-0.106-0.289v-5.472l3.481-4.477l6.467-1.492l1.989-4.974l-1.989-8.456l5.969-10.943l-2.487-7.959l-10.942-2.984l-6.467,8.456  l-9.451-1.492l-5.472,5.969l-0.994-14.425l-5.472-4.477l8.456-5.472l-1.492-9.451l-3.979-5.472l-7.461-2.486v-7.462h-3.979  l-6.964,4.975l-2.487-3.482v-8.455l-7.959-5.472l-2.984-7.462l-11.44,5.472l-5.472-6.964l-5.969,4.975l-9.948-5.969l0.497-9.451  l-4.477-5.472l-10.943,0.497l-4.477,10.446l-5.969,10.942l-26.86,1.493l-10.943-0.995l-3.481,11.44l2.487,4.974l7.461,8.954  l13.928,4.477l-2.984,11.938l7.461,8.954v8.456l-8.456,2.984l-6.964,0.995l-6.467,14.922l-7.461,8.953l-6.964,11.938l8.953,8.456  l-3.481,5.472l6.964,7.958l-0.995,13.928l4.477,4.478l6.964,8.456l1.492,6.466l0.498,9.451l-4.975,13.43l8.954,1.492l8.456-1.989  l19.896,9.948h7.958l9.451,5.472l10.943,0.497l6.466,9.948l-3.979,7.462v4.477l0.497,9.948l5.969,0.995l5.969,9.45l10.943-0.994  l4.975,3.979h5.472l10.942,9.451l0.498,4.477l7.958,0.498l7.024,5.059"
            />
            <path
                id="Tirol"
                sodipodi:nodetypes="ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccssscccccccccccccccccccccccccccccccccccccccccccccccc"
                fill="#B1D1A3"
                stroke="#284566"
                stroke-width="2"
                d="  M717.594,556.544l-8.969,6.969l-10.438,5.969l6.469,15.906l1,17.406l-10.969,2.5l-28.344-3.469l-3.469,2.469l-6.469-2.469  l-37.313,9.938l-2,7.969l-16.406-3l-26.375,2.5l-8.938-3.5l-11.438,9.969v13.406l-6.969,7.969l-16.406,2l-14.938-3.5l-12.938,15.938  l5.969,1.469l-1.469,7.469l-14.438-0.5l-11.438,10.469l-1.5,5.969l-7.469,5.969l-8.438-1.5l5.469-8.969l-4.969-3.969l-6.969,1.5  L447,682.387l-11.938,12.938l-14.438-1.5l-10.938,3l-11.438-6.469l4.969-6.969l-17.406-22.375l-10.469,1l-2.969-5.469l10.938-7.469  l-8.938-7.969l-17.406,6.969H347l-1.969-6.469l-9.969,0.5l-6.969-8.469l-13.906,0.5l-7.969-4.469l-7.969,7.469l-0.5,5.969h-13.406  l-10.469-6.969l2-6.469l-0.5-4.469l-13.438,3.969l6.469,7.969l-4.969,7.469l3.5,6.438l-3,5.969l8.969,5l2.469,19.375l-10.938,13.438  l-1,7.469l-4.969-0.5l-6.969,7.469l2.5,3.469l-14.438,18.406h-6.969l-6.969,6.969l-10.938,4.469l-7.469-1.5l-7.875,2.469  l-0.063,0.531l3.469,11.938l4,10.938l1.469,9.969l-1.969,10.438l-5.469,10.938l-6.969,10.438l-2.5,7.469l1.5,8.469l-4.969,9.438  l-1,4.469l2.469,9.469l0.5,8.438l-3.969,9.469l-8.969,6.969l1,11.938l8.469,4.969l-0.469,14.219l11.406,0.188l8.969-6.938l10.438-3  l0.5-9.938l2.969-10.469l13.438,2.5l3.969-1.5l-1.469-5.969l5.969-4.969l5.469-14.906l3.969,0.469l4.469-1.469l11.438,7.438  l1.5,6.469l12.938,10.469l-5.969,15.406l1.5,5.469l9.938,6.969l16.906,1l14.938-7.469l13.938,0.5l7.438,7.469l11.438,2.969  l1.5,5.969l-6.969,8.969l6.469,1.5l7.469-3.5l4.969,5.969l10.938,1l7.469,4.969l18.906-4.469l15.406,3.469l3-10.938l9.438-8.438  v-14.438l6.469-6.469l-1.5-12.938l19.906-23.375l18.406-1.5l19.406-6.469l11.438,2l6.469,4.469l9.938-2.469l10.938-14.438H538  l8.469,7.469l18.906-7.969l25.375,7.469l5.469,5.469h9.438l1-6.469l14.938-1.5l29.344-16.906l28.844-7.469l7.969-8.938l5.469-1.219  v-10.219l-0.5-11.938l-4-4.469l-7.438-3l-1-11.438l-0.5-14.438l3.469-6.469l-2.969-11.938l6.469-3.469l13.906,1l10.969-5.969  l14.406-6.469l8.969-7.969l5.469-1.969l12.438,8.438l22.875-8.938l-0.5-7.469l13.438-12.938h9.938l6.469-2.969l5.469-7.469  l2.5-8.469l1.969-8.438l4.5-5.969l6.938-11.469l-3.969-5.469l-4.969-5.969v-7.438l-1-10.969l-8.938-3.969l-7.969-4.969l-2.75-10.531  l-6.219-1.906l-7.438,5.469l-15.438-12.938l-4.969-10.938l-16.906,4.469l-9.969-2.969l-17.406,5.969l-3.969-9.469l5.469-7.438  L717.594,556.544z M796.906,589.794l0.25,0.094l-0.5-1L796.906,589.794z M693.219,803.544l13.125-2.802l6.313-1.302l6.063,4.822  l-6.125-4.969l-9.281,2.031L693.219,803.544z M718.719,804.262l1.844,1.5l-8.938,17.406l-15.938,3.969v18.406l7.469,10.938l1,7.469  l14.906,9.438l10.469-0.969l3.469,3.469l8.469,15.438l-4,19.375l9.969,4c0,0,7.947-0.997,9.938-0.5c0.007,0.002,0.022-0.002,0.031,0  c0.031,0.013,0.092,0.041,0.125,0.063c2.062,1.487,6.313,20.313,6.313,20.313l10.938,6.469l34.813,15.938l11.938,1.469l12.938-0.25  l2.094,1.906l1.406-5.125c0,0,3.948-8.893,6.438-10.438c2.486-1.492,3.5-12.438,3.5-12.438l0.5-12.938l8.438,0.5l10.469,0.5  l9.438-5.469l10.938-6.469l7.969,6.969l8.469,0.969l-2-11.438l-7.469-7.438l-7.969-10.969l-8.938-7.438l-7.469-8.469l-1-10.938  l-3.969-10.938l-9.438-1.5l-3.5-8.469l-5.969-7.438l2.5-9.469l4.969-13.438l-15.438-4.469l-15.906-3.469l-2.969-11.938l-4-4.5  l-11.938-8.438h-9.438l-6.469-1.5l-7.469-4.469l-8.938,7.938l-8.969-1.969l-11.438,2.969l-2.969,8.469l-3.5,5.969L733,800.794  l-13.938,3.469H718.719z M185.875,904.044h-0.5l0.469,1.188L185.875,904.044z"
            />
            <path
                id="Salzburg"
                sodipodi:nodetypes="ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccsccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc"
                fill="#B1D1A3"
                stroke="#284566"
                stroke-width="2"
                d="  M819.165,788.418l4.975-3.979l1.492-7.461l12.435,5.969l6.964,4.477l7.959,4.975l11.938,1.492l14.426,1.989h9.948l10.943,5.97  l10.942,5.969l10.943,6.466l11.938-2.486h8.953l10.445,0.994l11.938-4.477l7.461-1.492l1.989-6.964l4.975-9.948l10.943-2.984  l7.958,2.984l8.954,4.975l10.943,0.994l10.942,0.498h7.959l10.445,3.481l4.975,1.99l11.938-0.498h8.954l5.471,3.482l5.97,5.969  l6.466,5.472l7.959,3.481l10.943,7.959l5.969-2.487l5.472-5.969l-0.497-7.959l3.979-7.461l3.979-7.959l4.975-6.964l-1.99-12.435  l2.487-6.964l10.943-7.462l2.984-4.477l-0.497-6.466l-9.451-2.487l-3.979-2.487l-6.467-13.43l-4.974-9.948l-5.472-8.954  l-6.467-13.43l-6.963,0.497l-1.492,5.472l-1.99,3.481l-10.943-2.984l-4.477,3.979l-2.984,2.984l-11.44-6.964l-7.959-5.472  l-3.979-1.989l-5.969-19.896l-5.472-13.928l-2.984-10.943l3.482-14.922l0.994-2.985l-8.953-5.969l-7.959-6.466l-10.445-6.467  l-0.497-8.456l2.984-8.953l4.477-7.959l-0.995-7.959l-3.481-3.481l4.974-15.42l4.478-13.928l-0.995-6.466l-3.482-1.492l-8.456-0.995  l-9.948-5.969l-5.969-4.975v-1.989h21.389l2.984-2.984l-0.497-4.478l-12.933-5.969l-17.907-1.492l-8.456,0.497h-12.436l-4.974-9.45  l-5.969-18.902l-3.979-15.42l3.481-11.938l12.436,0.497l6.467,0.498v-6.467l-3.979-5.969l-9.948-1.99l-9.948,1.492l-6.467,5.97  l-16.415,0.497l-16.912-2.487l-10.942-9.948l-4.975-4.974l-9.451,0.497l-7.958,2.487l-5.472,0.497l-1.99,4.975l-2.984,8.456  l-14.453,3.872l-0.469-0.888l3.481,4.477l3.482,3.979l7.958,2.984l11.44,16.912l12.436,19.896l-8.953,18.901l-7.461,8.456  l0.497,10.943l-4.975,10.446l3.482,4.974h16.912l7.461-6.466l10.943,10.942l3.979,9.948l5.969,10.943l-6.467,6.964l-0.497,12.933  h-4.974l-1.99,4.975l4.477,4.974l-4.477,6.467l-0.497,5.472c0,0,2.984,5.969,5.472,5.969c2.486,0-0.995,8.456-0.995,8.456  l-6.467,2.487l-3.481,7.958l-5.472-6.964l-6.964,4.478l-18.901-11.441l-0.498-4.477l-11.938-10.445h-7.959L851,608.353l3.481-10.942  l6.467-0.995l-3.482-6.964l-12.436-5.969l0.498-7.959l-8.456-4.477l-4.975,1.492l-10.445-0.497l-7.959,3.979l-8.456-0.497  c0,0-4.726,11.316-8.456,14.425l-0.497-0.994l2.984,11.44l7.959,4.974l8.953,3.979l0.995,10.943v7.461l4.974,5.969l3.979,5.472  l-6.964,11.44l-4.477,5.97l-1.989,8.456l-2.487,8.456l-5.472,7.461l-6.467,2.984h-9.948l-13.43,12.933l0.497,7.461l-22.881,8.954  l-12.436-8.456l-5.472,1.989l-8.953,7.959l-14.425,6.466l-10.943,5.97l-13.928-0.995l-6.467,3.481l2.984,11.938l-3.481,6.466  l0.497,14.426l0.995,11.44l7.461,2.984l3.979,4.477l0.498,11.938v10.942l0.105-0.729l6.857-1.509l12.436-2.735l5.959,4.466  l0.508,0.508l13.928-3.481l11.44-7.959l3.481-5.969l2.984-8.456l11.441-2.984l8.953,1.989l8.953-7.958l7.462,4.477l6.466,1.492  h9.451l11.938,8.456L819.165,788.418"
            />
            <path
                id="Kärnten"
                sodipodi:nodetypes="ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccsccccccccccccccccccccccc"
                fill="#B1D1A3"
                stroke="#284566"
                stroke-width="2"
                d="  M819.841,788.187l4.975-3.979l1.492-7.461l12.436,5.969l6.964,4.477l7.958,4.974l11.938,1.493l14.425,1.989h9.948l10.943,5.969  l10.942,5.969l10.943,6.467l11.938-2.487h8.953l10.445,0.995l11.938-4.477l7.461-1.492l1.99-6.964l4.974-9.948l10.943-2.984  l7.959,2.984l8.953,4.974l10.943,0.995l10.942,0.497h7.959l10.446,3.482l4.974,1.989l11.938-0.497h8.953l5.472,3.481l5.969,5.97  l6.466,5.471l7.959,3.482l10.943,7.959l1.492-0.498l6.467,10.446l6.963,4.974l5.472,2.487l10.943-4.975l2.984-6.964l7.959-6.964  l6.964-3.481l3.481-6.467l3.482-6.964l5.969-5.471l7.461-2.984l7.959-4.975l7.959-3.979l5.969-2.984l6.466-0.995h3.482l4.477-1.492  l4.477-0.994l2.984,4.974l3.482,5.969l6.466,1.492l6.964-0.497l9.948-0.995l2.985-0.994l3.979,9.45l3.482,1.99h6.466l6.467-3.482  l4.974-4.477l4.975-3.481h3.979l4.477-1.492l12.436-0.498l4.477-2.487h4.477l5.969,1.492h4.478l5.969-1.989h5.472l7.461-0.497  l6.964-0.995l5.472-0.497h6.466l4.975-1.492l8.953-3.482l5.969-1.989l5.97,5.969l7.958,3.979l4.975,5.969l5.472,8.953l5.472,7.462  l7.461,9.45l3.979,5.97l0.497,8.953l-4.477,7.959l-1.99,6.466l1.493,7.959l2.984,5.472l3.481,3.979l2.984,8.953v11.938l1.492,11.441  l0.995,3.979l6.467,2.487l8.456,6.964l6.788,3.919l-1.814,1.553l-17.409,3.979l-5.472,10.942l-2.984,4.975l-9.948-10.445  l-5.969,8.456l-14.426,1.492l-10.943,39.295l-20.394,4.478l-5.472,13.43l-6.466,0.995l-4.478,7.461l-18.901,5.472v12.933  l-4.477,7.461l-14.425-13.43l-4.477,4.477l-6.965-2.984l-5.969-3.979l-5.969-6.466l-18.404,3.979l-9.948,3.482l-6.964-3.482  l-15.917,2.487l-16.912,2.487l-10.943-15.917l-16.415-1.99l-14.922,0.995l-18.404-12.436l-16.912,0.498l-11.938,6.963l-21.886-1.989  l-25.866-9.451l-8.456,4.975l-7.958-7.461l-7.959,1.989l-7.461-5.969l-13.928,4.477l-8.954-5.969l-21.886,8.456l-19.896,0.994  l-21.389-10.942l-22.881-1.492l-27.358-1.492l-25.368,0.497l-21.389-11.44l-4.975-2.487l-15.419,0.497l-10.393-0.649l1.554,0.813  l1.377-5.138c0,0,3.979-8.954,6.467-10.446s3.481-12.435,3.481-12.435l0.498-12.934l8.456,0.498l10.445,0.497l9.451-5.472  l10.942-6.466l7.959,6.964l8.456,0.994l-1.989-11.44l-7.462-7.461l-7.958-10.943l-8.954-7.461l-7.461-8.456l-0.995-10.943  l-3.979-10.943l-9.451-1.492l-3.482-8.456l-5.969-7.461l2.487-9.451l4.974-13.43l-15.419-4.477l-15.918-3.482L819.841,788.187"
            />
            <path
                id="Steiermark"
                sodipodi:nodetypes="ccccccccsccccccccccccccccsccscccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccscccccccccccccc"
                fill="#B1D1A3"
                stroke="#284566"
                stroke-width="2"
                d="  M1323.281,513.201l2.345,4.062l5.472,4.477l5.969-4.974l13.928,0.497l5.472,0.995l3.979,1.989l7.958,6.964  c0,0,3.482,0.498,6.467,0.995s6.466-2.487,6.466-2.487l4.975-11.44l5.969-1.492l8.953-0.995l5.97,3.482l4.974-1.492l8.456-4.478  l9.451-3.979l10.445-2.487l3.979-11.44l2.984-1.99l4.975-5.471l6.466,1.492l7.959-1.99l4.477-4.477l4.975-0.995c0,0,4.477,0,7.958,0  c3.482,0,9.948,9.451,9.948,9.451l5.97,7.461c0,0,8.953,0.995,10.942,0.995c1.99,0,9.948,2.984,9.948,2.984l6.964,8.456  l10.446-1.492h10.943l4.477,9.948l5.969,0.995l7.959,0.994h8.953l4.477,12.436l6.964,16.912l5.969-10.943l10.446,0.498l3.481,12.933  l-0.995,9.948l10.446-0.995l6.466,5.472l4.478,6.964l3.481,7.462h9.948h11.44l2.487,3.481l3.481,1.989l9.451-0.497l5.969-5.969  l0.995,15.42l5.472,5.472l8.456,7.958l-6.964,11.44l-7.461,10.446l-5.472-10.943h-4.975v3.979l-0.497,6.466l-3.979,2.487  l3.482,10.943l4.477,10.943l2.984,8.456l4.974,10.942l1.99,11.441l0.497,9.45l3.979,6.964l4.477,5.969l0.498,5.472v8.456  l-2.985,11.44l1.493,8.954l7.958,8.456l8.456,5.472l-0.497,9.948l-4.975,7.461l-5.472,9.948l-5.471,8.953l-3.979,7.959l-3.482,0.497  l-7.461,5.97l0.995,12.933l3.481,4.974l5.472,4.975v5.969l-2.487,2.487l-7.958,1.989l3.979,6.467v14.425l1.492,12.933l4.478,6.964  l5.969,0.995l0.995,5.969l4.477,3.979v12.933h-4.477l-10.446-13.43l-4.974,1.989l-27.358-10.943l-14.922,3.979l-10.446,7.461  l-8.456,1.99h-4.974l-5.969-3.482h-6.965l-2.984,8.954l-1.492,3.481l-7.958-2.984l-13.928,5.969v6.467v7.461l-7.959,6.467  l-11.44,1.492l-6.466-5.969l-4.975-4.975h-9.451l-24.87,3.482l-20.892,1.989l-10.446-3.979l-19.398,3.482l1.813-1.553l-6.788-3.919  l-8.456-6.964l-6.466-2.487l-0.995-3.979l-1.492-11.44v-11.938l-2.984-8.954l-3.482-3.979l-2.984-5.471l-1.492-7.959l1.989-6.467  l4.478-7.958l-0.498-8.954l-3.979-5.969l-7.461-9.451l-5.472-7.461l-5.472-8.953l-4.974-5.97l-7.959-3.979l-5.969-5.97l-5.969,1.99  l-8.954,3.481l-4.974,1.492h-6.467l-5.472,0.498l-6.963,0.994l-7.462,0.498h-5.472l-5.969,1.989h-4.477l-5.969-1.492h-4.477  l-4.478,2.487l-12.435,0.497l-4.478,1.492h-3.979l-4.975,3.482l-4.974,4.477l-6.467,3.481h-6.467l-3.481-1.989l-3.979-9.451  l-2.984,0.995l-9.948,0.995l-6.964,0.497l-6.467-1.492l-3.481-5.969l-2.984-4.975l-4.477,0.995l-4.478,1.492h-3.481l-6.467,0.995  l-5.969,2.984l-7.958,3.979l-7.959,4.974l-7.461,2.984l-5.97,5.472l-3.481,6.964l-3.482,6.467l-6.963,3.481l-7.959,6.964  l-2.984,6.964l-10.943,4.975l-5.472-2.487l-6.964-4.975l-6.467-10.445l-1.492,0.497l5.97-2.487l5.472-5.969l-0.498-7.958  l3.979-7.462l3.979-7.958l4.974-6.964l-1.989-12.436l2.487-6.964l10.942-7.461l2.985-4.478l-0.498-6.466l-9.45-2.487l-3.979-2.487  l-6.467-13.43l-4.974-9.948l-5.472-8.954l-6.467-13.43l-6.964,0.497l-1.492,5.472l-1.989,3.482l-10.943-2.985l-4.477,3.979  l-2.984,2.984l-11.44-6.964l-7.959-5.471l-3.979-1.99l-5.969-19.896l-5.472-13.928l-2.984-10.943l3.481-14.922l0.995-2.984h-0.497  l9.948,2.487l11.44,1.492l6.466,1.492l1.493-5.472l1.492-4.477l6.466-4.478l1.492-1.492v-7.958l-1.989-5.472l-4.975-5.969  l-5.472-4.478l-2.984-5.471l-0.994-6.467v-6.964v-7.959l0.497-8.953l0.995-2.487l16.414-9.948l11.44-6.466l7.959-5.97l8.953,6.467  l3.979,0.995l8.953,0.994l2.487-0.497l3.482,3.481l9.45-2.486h0.995l8.456,7.461l8.456,7.461l0.995,4.975l-0.498,6.466l3.979,0.498  l2.985-6.964l7.958-0.995l6.467-0.497l3.481-5.472l6.964-1.492h3.979l5.969,6.964l5.472,3.481l15.42,1.99c0,0,4.477,0,6.467,0  c1.989,0,6.964-1.492,6.964-1.492l1.989-4.975l6.466-9.948l3.482-2.984h5.472l7.958-0.497l3.482-4.975l-0.497-4.974l12.435-4.975  l6.467-2.487l13.431-4.974l8.953-3.979l7.958-9.451l5.472-4.974"
            />
            <path
                id="Oberösterreich"
                sodipodi:nodetypes="ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccsccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc"
                fill="#B1D1A3"
                stroke="#284566"
                stroke-width="2"
                d="  M862.699,456.578v-6.964l-2.396-5.951l0.406-1.013l-6.467-5.969l-12.436-7.461l-4.974-10.943l-3.482-12.933l4.975-2.487l6.964,0.994  l-0.497-5.969l3.481-4.974l7.959-3.979l0.994-6.467v-6.466l5.97-3.482h8.953l7.959-1.492l6.466-1.492l2.487-4.477l4.975-8.456  l1.989-4.975l6.467-0.994h7.461l3.979-2.487l2.984-2.984l5.472-0.497l4.974-4.478l8.456-3.979l19.399-0.498l5.969-1.989  l10.943-7.959l7.461-8.456l6.964-7.461l4.975-5.969l1.492-5.97l1.989-4.974l1.492-4.975v-7.461l-0.497-6.964v-5.969l1.492-5.969  l4.974-7.462l-3.481-8.953l-2.487-6.964v-5.472l4.975-3.979l6.964-2.984l7.461-1.989l6.466,4.477l3.979,3.979l5.97-1.99l3.481-0.497  l4.477,3.482l7.959,0.497l1.989,3.979l2.984,3.481l7.462,4.477l4.477,1.99l3.481-4.477l0.995-12.436l6.467-0.995l7.958-7.461v-7.959  l5.969-6.964L1084.547,183l3.979-5.969l-10.445-8.456l4.477-5.472l1.99-4.975l1.989-7.958l6.467,0.994l6.964,0.498l19.398,15.917  l9.948,0.995l6.964,10.445l6.964,4.477v5.97l-7.461,3.481v4.477l4.974,4.477l0.498,3.979l8.953,4.975l30.343,0.497l7.958,4.477  l7.462,0.498l6.466,0.994l6.467,1.99l7.461,4.974l7.461-7.958l5.472-6.467l5.969,0.497l4.478-9.948v-10.942l9.948-2.487l5.969,6.964  l6.466,2.984l6.467,2.984l4.975-4.975l4.974-3.979l4.477,2.486l1.492,5.97h7.959l2.487,7.958l7.461,0.498l0.497-0.498v5.472h8.456  l8.456,1.492l9.948,3.979l8.954,2.984l10.942,0.995l9.451,5.969l-1.492,5.472l-4.974,0.497l-4.478,6.467l-1.492,4.477l1.492,4.975  l11.441,8.953l4.974,1.989l0.497,12.436h5.97v3.482l0.497,9.45l-0.497,4.975l3.979,6.466l0.994,7.462l-0.497,11.44l0.497,9.948  l1.492,15.917l-3.481-1.989l-4.477-1.99l-3.979-3.481l-5.472,0.497l-4.477,0.498l-4.975,3.481l-6.466,6.964l-4.975,6.466  l-4.974,1.99l-5.97,1.492l-5.471,1.492l-5.97,1.492l-8.953,2.487l-9.948-2.984l-3.482-2.487l-5.471-5.969l-5.97-6.467l-1.492-3.979  l-6.964-0.497l-8.953-0.995l-9.948,7.959l-0.995,8.953l0.995,10.446l-2.487,9.948l4.975,9.45l-1.99,3.482l-2.486,6.964l-4.478,9.451  l1.99,7.461l9.948,7.958l5.472,4.478l5.472,4.477l5.471,0.995l4.975,2.984l3.979,3.979l7.461,5.969l7.959,2.487l5.969,2.486h5.472  l7.959,3.482l8.953,7.461l1.492,7.959l-3.979,2.984v6.964l-3.481,7.461l-2.487,4.477v5.97l3.481,9.45l-1.492,8.954l-5.472,4.974  l-7.958,9.451l-8.954,3.979l-13.43,4.974l-6.467,2.487l-12.436,4.975l0.498,4.974l-3.482,4.975l-7.958,0.497h-5.472l-3.482,2.984  l-6.466,9.948l-1.99,4.975c0,0-4.974,1.492-6.964,1.492c-1.989,0-6.466,0-6.466,0l-15.42-1.99l-5.472-3.481l-5.969-6.964h-3.979  l-6.964,1.492l-3.481,5.472l-6.467,0.497l-7.959,0.995l-2.984,6.964l-3.979-0.498l0.498-6.466l-0.995-4.975l-8.456-7.461  l-8.456-7.461h-0.995l-9.45,2.486l-3.482-3.481l-2.487,0.497l-8.953-0.994l-3.979-0.995l-8.953-6.467l-7.959,5.97l-11.44,6.466  l-16.415,9.948l-0.994,2.487l-0.498,8.953v7.959v6.964l0.995,6.467l2.984,5.471l5.472,4.478l4.975,5.969l1.989,5.472v7.958  l-1.492,1.492l-6.467,4.478l-1.492,4.477l-1.492,5.472l-6.466-1.492l-11.44-1.492l-9.948-2.487h0.497l-8.953-5.969l-7.959-6.467  l-10.446-6.467l-0.497-8.456l2.984-8.953l4.477-7.959l-0.994-7.958l-3.482-3.482l4.975-15.42l4.477-13.928l-0.995-6.466  l-3.481-1.492l-8.456-0.995l-9.948-5.969l-5.97-4.975v-1.989h21.39l2.984-2.984l-0.498-4.477l-12.933-5.97l-17.906-1.492  l-8.456,0.498h-12.436l-4.975-9.451l-5.969-18.901l-3.979-15.42l3.482-11.938l12.435,0.498l6.467,0.497v-6.467l-3.979-5.969  l-9.948-1.989l-9.948,1.492l-6.467,5.969l-16.414,0.497l-16.912-2.486l-10.943-9.948l-4.974-4.975l-9.451,0.497l-7.959,2.487  l-5.472,0.497l-1.989,4.975l-2.984,8.456l-14.454,3.873"
            />
            <path
                id="Burgenland"
                sodipodi:nodetypes="cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc"
                fill="#B1D1A3"
                stroke="#284566"
                stroke-width="2"
                d="  M1899.581,328.97l-6.716,6.715l-6.466,6.467l-2.487-2.984l-10.943,3.979l2.984,8.456l-0.497,7.958l-2.984,3.979l-5.472-3.979  l-9.948-6.964h-8.456l-7.959,6.964l-5.969,8.456l-10.445,5.97l-9.451,3.979l-7.461,3.979l-0.498,10.943l-1.989,5.969l-7.461,3.979  l-6.467,2.984v8.456l-4.974,4.477l-6.964,5.472l-4.975-4.974l-9.451-5.97l-5.969,1.99l-12.436,2.487l-6.964,5.969l-3.481,4.975  l-6.964,9.948l1.492,7.958l1.492,9.451l-4.477,7.461v6.964l-6.467-0.994l-5.969,5.471v11.441l1.99,8.456l1.492,4.477l4.477,6.964  l5.472,4.477l8.456,8.456l3.481,4.477l0.497,5.472l-4.477,5.472v5.969l-1.989,5.472l-4.975,3.979l-0.994,5.969l0.497,9.948  l7.959,7.959l-2.984,7.958l-6.964,7.959l-7.959,6.467l-8.456,7.461l-9.451,0.995l-11.44,0.994l0.497,0.498l-6.963,11.44  l-7.462,10.445l-5.472-10.943h-4.974v3.979l-0.497,6.467l-3.979,2.487l3.481,10.942l4.477,10.943l2.984,8.456l4.975,10.943  l1.989,11.44l0.498,9.451l3.979,6.964l4.477,5.969l0.497,5.472v8.456l-2.984,11.44l1.492,8.953l7.959,8.456l8.456,5.472  l-0.498,9.948l-4.974,7.461l-5.472,9.948l-5.472,8.954l-3.979,7.958l-3.481,0.498l-7.462,5.969l0.995,12.933l3.482,4.975  l5.472,4.974v5.969l0.001,0.776l5.47-3.761l9.451-7.461l9.451-2.487l9.45-14.425l4.975-6.467l1.989-7.958l8.954-0.995l1.989-4.477  l1.99-6.467l4.974-4.974l1.989-5.969l0.995-5.97l3.482,2.984h3.979l8.455-3.481l6.467,1.989l5.969-3.481l7.462,4.477l4.477-3.481  l3.979,0.994l9.45-0.497l2.487-2.487l-2.487-3.481l-6.964-1.99h-8.456l1.492-5.472l12.436-5.471l3.482-6.964h-7.462l-5.471-9.451  l4.477-4.975l3.979-4.477l2.984-1.989l2.486-5.472l-3.481-4.477l-6.467,0.497l-8.953,6.467l-2.487-8.954l2.984-3.979l-2.984-5.472  h-3.979l-3.481-7.462l3.481-5.472l0.498-14.922l-0.498-9.451l3.979-6.964l-0.497-12.436l-6.964-1.492l1.492-13.927l-2.984-9.451  l2.487-4.975h4.477l6.964,6.964l5.969-6.964l11.44-0.497l16.415-15.42l5.969-7.461l-2.487-6.467l-1.989-7.461l6.964-2.984  l5.472-4.477l-0.498-8.456l-10.942-6.964l-0.995-13.928l-9.948-8.456l-8.456,3.481l-19.399-7.461l-6.964,2.487l-17.409-6.964  l4.974-7.462h6.467l4.974-8.456l11.938-6.466l-3.482-8.954l2.487-5.471h10.943l7.959-3.979l7.958,5.969l8.456-0.497l1.492,3.481  h4.477l3.979,2.487l2.984,7.959l6.467,3.481l18.404,4.975l5.969-17.41l5.97,9.451l35.316-10.446l14.425-0.497l-5.97-9.948  l0.498-14.922l-5.472-5.97l-0.497-4.477l2.486-5.472l-2.984-5.472l-12.436-8.953v-2.984l11.441-2.487l8.455-9.948l-0.994-15.42  l2.487-8.456l-1.99-5.472l11.44-16.415l-3.979-4.974l-14.426-0.497l-2.486-11.441l-0.498-11.44l-1.492-7.461l-2.707-3.332"
            />
            <path
                id="Niederösterreich"
                fill="#B1D1A3"
                stroke="#284566"
                stroke-width="2"
                d="M1364.541,39.125l-1,8.469l-2.969,7.969l5.469,22.875  l-1.5,7.469l-1.969,7.938l0.969,6.469l-0.469,5.969l-3,9.469l2,6.469l3.469,6.469l-2.969,6.469h-3l-5.469-3l-12.938-2h-14.406  l-2.5,18.406L1308.854,165l-3.5,13.406l1,17.406l-3.469,11.938l0.469-0.469v5.469h8.469l8.469,1.469l9.938,4l8.969,2.969l10.938,1  l9.438,5.969l-1.5,5.469l-4.969,0.5l-4.469,6.469l-1.5,4.469l1.5,4.969l11.438,8.969l4.969,2l0.5,12.438h5.969v3.469l0.5,9.438  l-0.5,5l3.969,6.438l1,7.469l-0.5,11.438l0.5,9.969l1.5,15.906l-3.469-2l-4.5-1.969l-3.969-3.5l-5.469,0.5l-4.469,0.5l-4.969,3.5  l-6.469,6.938l-5,6.469l-4.969,2l-5.969,1.5l-5.469,1.469l-5.969,1.5l-8.938,2.5l-9.969-3l-3.469-2.469l-5.469-5.969l-5.969-6.469  l-1.5-4l-6.969-0.469l-8.938-1l-9.969,7.938l-0.969,8.969l0.969,10.438l-2.469,9.938l4.969,9.469l-2,3.469l-2.469,6.969l-4.5,9.469  l2,7.438l9.938,7.969l5.5,4.469l5.469,4.5l5.469,0.969l4.969,3l3.969,3.969l7.469,5.969l7.969,2.5l5.969,2.469h5.469l7.938,3.5  l8.969,7.469l1.5,7.938l-4,3v6.969l-3.469,7.438l-2.5,4.5v5.969l3.5,9.438l-1.688,8.656l2.188,3.781l5.469,4.469l5.969-4.969  l13.906,0.5l5.5,1l3.969,1.969l7.969,6.969c0,0,3.453,0.503,6.438,1c2.984,0.498,6.469-2.469,6.469-2.469l5-11.469l5.969-1.469  l8.938-1l5.969,3.469l4.969-1.469l8.469-4.5l9.438-3.969l10.469-2.5l3.969-11.438l2.969-1.969l5-5.469l6.469,1.469l7.938-1.969  l4.469-4.5l5-0.969c0,0,4.456,0,7.938,0c3.482,0,9.969,9.438,9.969,9.438l5.969,7.469c0,0,8.948,1,10.938,1  c1.99,0,9.938,2.969,9.938,2.969l6.969,8.469l10.438-1.5h10.938l4.5,9.938l5.969,1l7.938,1h8.969l4.469,12.438l6.969,16.906  l5.969-10.938l10.438,0.5l3.5,12.938l-1,9.938l10.438-1l6.469,5.469l4.469,6.969l3.5,7.469h9.938h11.438l2.5,3.469l3.469,2  l9.469-0.5l5.969-5.969l0.969,15.406l5.5,5.5l7.938,7.438l11.438-1l9.469-0.969l8.438-7.469l7.969-6.469l6.969-7.969l2.969-7.938  l-7.938-7.969l-0.5-9.938l1-5.969l4.969-4l1.969-5.469v-5.969l4.5-5.469l-0.5-5.469l-3.5-4.469l-8.438-8.469l-5.469-4.469  l-4.5-6.969l-1.469-4.469l-2-8.469v-11.438l5.969-5.469l6.469,1v-6.969l4.469-7.469l-1.5-9.438l-1.469-7.969l6.969-9.938  l3.469-4.969l6.969-5.969l12.438-2.5l5.969-2l9.438,5.969l4.969,4.969l6.969-5.469l4.969-4.469v-8.438l6.469-3l7.469-3.969l2-5.969  l0.5-10.969l7.438-3.969l9.469-3.969l10.438-5.969l5.969-8.469l7.969-6.969h8.438l9.969,6.969l5.469,4l2.969-4l0.5-7.938  l-2.969-8.469l10.938-3.969l2.469,2.969l6.469-6.469l6.719-6.719l-0.188-0.344l-3.531-4.375h-4.469l-5.969-2l-6.469-6.938l-5.469-1  l-3-10.469l-2-7.438l-2.969-7.969v-11.438l-7.469-2l-2-2.969l-5.469-6.969l-1.969-8.969l-12.938-6.938l-3-8.969l3.5-4.469  l-0.5-25.375l5.969-12.938l5.969-10.938l6.969-11.938l-4.969-13.938v-7.438l-2.5-8.469l-8.469-26.875l-7.438-8.938l-10.469,5.969  h-14.406l-6.969-7.969l-10.938-1.5l-1.5,4.5l-4.969,2.469l-2-6.469v-8.438l-7.469-6.969l-10.438,4.969l-18.406-9.938l-7.469,4.969  l-9.938-2.5l-7.969,22.406l-10.938,7.938l-4.469-3.969h-4.469l-4,5.969l-3.469-3.469h-2.5l-16.406,1.469l-17.906-3.469l-4.969,3.969  h-10.938l-34.344-19.406l-4.969-7.938l-27.844-14.438h-13.438l-1,3.5l-2.469,4.969l-17.906-1.5l-2.5-3.469l-5.969-4l-8.469-4.469  l-12.406-1.5l-14.438-2.969l-9.438-12.938h-11.938l-19.406-9.469l-8.969,3.5l-7.938-5.469l-3.5,15.406l-11.438-0.5L1412.791,64  l-7.438-0.969l4.969-8.969l-6.469-9.938h-17.406l-4-4L1364.541,39.125z M1724.885,261.687c0.067-0.006,0.152,0.006,0.219,0  c0.924,0.552,1.906,0.998,2.781,1.625c2.242,0.689,1.957,2.762,2,4.656c1.531,2.218,0.516,5.1,0.813,7.625  c3.576,2.508,7.131,5.037,10.625,7.656c0.465,0.674,0.925,0.806,1.313,0.656c0.868-0.372,1.445-2.262,1.25-3.25  c0.055-1.674-1.104-3.875-0.469-5.188c3.129-0.363,6.182,0.684,8.813,2.313c2.533,0.921,0.604,2.912-0.063,4.438  c-1.761,1.993,1.116,2.517,1.031,4.469c1.986,0.645,2.488,2.842,4.875,2.563c1.688-0.163,3.311-1.044,5.125-0.281  c-0.33,3.172-1.681,6.111-2.313,9.219c2.266-0.124,2.323,1.781,4.219,1.688c-1.057,2.555-1.488,5.281-1.875,8  c0.273,2.211-0.737,4.101-1.688,6.031c-1.089,1.616-1.513,3.351-0.813,5.219c0.896,1.925,0.704,3.845-0.125,5.75  c1.01,1.319-0.918,2.968-0.406,4.813c0.393,2.206,3.891,0.747,2.781-1.094c0.522,0.039,0.869,0.13,1.063,0.281  c0.005,0.004,0.027,0.027,0.031,0.031c0.005,0.005,0.027,0.027,0.031,0.031c0.009,0.009,0.023,0.022,0.031,0.031  c0.004,0.005,0.028,0.027,0.031,0.031c0.007,0.01,0.025,0.021,0.031,0.031c0.003,0.005-0.002,0.026,0,0.031  c0.416,0.831-1.4,2.534-0.688,3.813c0.04,0.068,0.102,0.153,0.156,0.219c0.152,0.175,0.373,0.349,0.656,0.5c0,0.007,0,0.025,0,0.031  c0.021,0.385,0.366,1.207,0.813,1.719c0.194,0.217,0.435,0.388,0.656,0.438c0.063,0.012,0.156,0.008,0.219,0  c0.292-0.048,0.613-0.293,0.875-0.906c0.097,0.343,0.236,0.607,0.375,0.781c0.045,0.054,0.107,0.118,0.156,0.156  c0.043,0.031,0.111,0.072,0.156,0.094c0.016,0.007,0.047,0.025,0.063,0.031c0.031,0.011,0.093,0.025,0.125,0.031  c0.033,0.006,0.091-0.002,0.125,0c0.043,0.002,0.111,0.004,0.156,0c0.632-0.068,1.439-0.623,2.375-1.094  c2.259-0.379,2.344,2.604,1.125,3.75c1.426,1.139,1.908,3.648,0.938,4.969c0.435,1.482,0.43,2.368,0.125,2.844  c-0.017,0.024-0.044,0.072-0.063,0.094c-0.012,0.015-0.049,0.05-0.063,0.063c-0.033,0.032-0.087,0.067-0.125,0.094  c-0.023,0.016-0.068,0.05-0.094,0.063c-1.521,0.749-5.621-2.009-7.844-2.281c-4.03-0.669-5.492-5.221-9-6.844  c-1.785-1.793-4.141-0.661-6.125,0.063c-1.841-0.599-2.786-0.745-4.25,0.688c-0.891-0.454-1.516-0.616-2-0.531  c-0.111,0.022-0.244,0.078-0.344,0.125c-0.044,0.022-0.113,0.067-0.156,0.094c-0.521,0.347-0.906,1.065-1.438,1.969  c-1.721,1.11-2.26,2.986-3.938,4c-1.876,2.979-5.058,2.452-8.344,2.438c-1.775,0.716,0.511,3.571-0.063,5.156  c0.188,1.02,0.6,1.948,0.594,2.469c-0.001,0.024-0.028,0.071-0.031,0.094c-0.002,0.015,0.004,0.049,0,0.063s-0.026,0.05-0.031,0.063  c-0.002,0.006,0.003,0.025,0,0.031s-0.027,0.026-0.031,0.031c-0.022,0.031-0.061,0.071-0.094,0.094  c-0.006,0.004-0.024,0.028-0.031,0.031c-0.052,0.024-0.144,0.024-0.219,0.031c-0.32,0.021-0.866-0.089-1.688-0.406  c-2.002-1.929-2.561,1.424-4.719,0.375c-0.259,0.577-0.516,0.913-0.75,1.063c-0.023,0.015-0.069,0.052-0.094,0.063  c-0.023,0.01-0.069,0.025-0.094,0.031c-0.031,0.007-0.093-0.001-0.125,0c-0.023,0-0.069,0.004-0.094,0  c-0.023-0.004-0.069-0.024-0.094-0.031c-0.032-0.011-0.092-0.016-0.125-0.031c-0.024-0.012-0.069-0.048-0.094-0.063  c-0.557-0.339-1.171-1.214-2-1.688c-2.556-0.188-4.433-2.409-7.063-1.969c-2.776-0.892-5.97-0.89-8.375-2.625  c-2.489-1.145-5.356-1.437-7.906-2.563c-0.092,0.062-0.198,0.138-0.281,0.219c-0.961,0.971-1.332,3.196-2,4.563  c-0.061,0.386-0.17,0.674-0.281,0.844c-0.051,0.073-0.13,0.146-0.188,0.188c-0.006,0.005-0.024,0.027-0.031,0.031  c-0.013,0.008-0.049,0.025-0.063,0.031s-0.049,0.026-0.063,0.031s-0.048-0.003-0.063,0c-0.014,0.004-0.048,0.029-0.063,0.031  c-0.238,0.036-0.519-0.019-0.75,0.031c-0.014,0.004-0.049-0.004-0.063,0c-0.014,0.005-0.049,0.025-0.063,0.031  c-0.013,0.007-0.049,0.024-0.063,0.031c-0.006,0.004-0.024,0.027-0.031,0.031c-0.05,0.037-0.111,0.097-0.156,0.156  c-0.157,0.229-0.271,0.637-0.313,1.344c-0.033,0.451-0.175,0.725-0.344,0.844c-0.067,0.042-0.166,0.061-0.25,0.063  c-0.884-0.016-2.526-1.969-3.25-2.563c0.211-1.135-0.054-1.723-0.563-2.031c-0.678-0.392-1.782-0.373-2.813-0.625  c-0.044,0.031-0.11,0.069-0.156,0.094c-0.015,0.008-0.047,0.024-0.063,0.031c-1.879,0.817-4.545-3.626-7.313-1  c-2.793,2.497-7.311-0.855-10.25,2.094c-1.543,0.83-3.403,2.175-4.938,1.031c0.902-1.898,3.193-1.496,4.813-2.281  c1.024-0.225,1.807-0.646,2.188-1.219c0.028-0.043,0.07-0.11,0.094-0.156c0.067-0.138,0.133-0.314,0.156-0.469  c0.053-0.402-0.055-0.868-0.344-1.375c-1.697,0.285-3.409,0.417-5.094,0.781c0.021-1.909-2.196-2.953-2.5-4.906  c-0.371-0.381-0.562-0.704-0.625-0.938c-0.006-0.025-0.028-0.069-0.031-0.094c0-0.006,0.001-0.025,0-0.031c0-0.006,0-0.025,0-0.031  c0-0.005,0-0.025,0-0.031c0.001-0.005,0-0.025,0-0.031c0.001-0.005,0.03-0.025,0.031-0.031c0.002-0.005-0.001-0.026,0-0.031  c0.002-0.005-0.002-0.026,0-0.031c0.006-0.014,0.024-0.049,0.031-0.063c0.003-0.004,0.028-0.026,0.031-0.031  c0.542-0.721,3.393-0.422,4.094-1.469c0.016-0.024,0.05-0.067,0.063-0.094c0.007-0.013,0.025-0.049,0.031-0.063  s0.027-0.048,0.031-0.063c0.007-0.021-0.005-0.07,0-0.094s0.028-0.069,0.031-0.094c0.002-0.016-0.001-0.046,0-0.063  c-2.129-0.177-4.234-0.435-6.344-0.781c-0.383,0.198-0.718,0.292-0.969,0.313c-0.079,0.005-0.182,0.011-0.25,0  c-0.015-0.003-0.048,0.004-0.063,0c-0.014-0.004-0.049-0.026-0.063-0.031c-0.013-0.005-0.05-0.025-0.063-0.031  c-0.006-0.003-0.024,0.004-0.031,0c-0.006-0.003-0.025-0.027-0.031-0.031c-0.012-0.007-0.051-0.023-0.063-0.031  c-0.005-0.004-0.025-0.026-0.031-0.031c-0.005-0.004-0.025-0.026-0.031-0.031c-0.01-0.01-0.021-0.021-0.031-0.031  c-0.758-0.854-0.202-3.7-1.281-5.094c-0.21-0.263-0.489-0.491-0.844-0.625c-1.604-0.127-2.304-0.416-2.5-0.813  c-0.35-0.813,1.27-2.106,1.344-3.563c0.86-1.155,2.539-2.239,3.219-3.563c1.383-0.819,1.146-3.102,1.469-4.625  c0.668-1.77,1.626-3.213-0.125-4.625c0.693-0.705,1.494-1.368,1.781-1.938c0.021-0.044,0.048-0.112,0.063-0.156  c0.014-0.043,0.025-0.113,0.031-0.156c0.004-0.033,0.002-0.092,0-0.125c-0.006-0.065-0.034-0.155-0.063-0.219  c-0.027-0.056-0.078-0.134-0.125-0.188c-0.014-0.015-0.047-0.047-0.063-0.063c-0.216-0.195-0.579-0.393-1.125-0.563  c-0.056,0.035-0.131,0.069-0.188,0.094c-0.031,0.014-0.093,0.021-0.125,0.031c-0.023,0.007-0.069,0.026-0.094,0.031  c-0.023,0.005-0.069,0.028-0.094,0.031c-0.031,0.004-0.093-0.001-0.125,0c-1.484,0.006-2.819-2.955-1.844-3.969  c0.006-0.005,0.026-0.025,0.031-0.031c0.006-0.005,0.025-0.026,0.031-0.031c0.012-0.01,0.051-0.021,0.063-0.031  c0.007-0.004,0.025-0.026,0.031-0.031c0.014-0.008,0.049-0.023,0.063-0.031c0.015-0.008,0.048-0.023,0.063-0.031  c0.06-0.027,0.15-0.075,0.219-0.094c0.079-0.02,0.19-0.023,0.281-0.031c0.082-0.005,0.189-0.006,0.281,0  c-0.004-0.06-0.017-0.134-0.031-0.188c-0.004-0.015-0.025-0.048-0.031-0.063c-0.005-0.014-0.024-0.049-0.031-0.063  c-0.006-0.013-0.023-0.05-0.031-0.063c-0.62-1.026-3.469-0.422-4.094-0.563c-0.021-0.006-0.048-0.022-0.063-0.031  c-0.002-0.001-0.029,0.002-0.031,0c-0.001-0.001,0.002-0.029,0-0.031c0-0.002,0-0.029,0-0.031c0.001-0.002,0-0.028,0-0.031  c0.003-0.005-0.003-0.025,0-0.031c0.097-0.141,0.447-0.396,1.125-0.781c0.856-1.216,2.293-1.339,2.781-1.875  c0.005-0.005,0.027-0.025,0.031-0.031c0.018-0.022,0.049-0.069,0.063-0.094c0.007-0.012,0.025-0.05,0.031-0.063  c0.003-0.006-0.002-0.024,0-0.031c0.005-0.014,0.028-0.048,0.031-0.063c0.005-0.021-0.002-0.071,0-0.094s0.001-0.069,0-0.094  c-0.003-0.041,0.01-0.11,0-0.156c-2.375-1.605-1.804-4.705-1.219-7.031c0.362-1.83,1.643-3.196,2.281-5  c0.502-0.61,0.693-2.043,1.125-2.75c0.077-0.12,0.187-0.245,0.281-0.313c0.06-0.038,0.151-0.081,0.219-0.094  c0.061-0.008,0.15,0.017,0.219,0.031c0.219,0.058,0.498,0.223,0.813,0.563c2.697,1.271,4.619,3.455,6.594,5.625  c0.874,0.022,1.539,0.37,1.906,0.875c0.484,0.692,0.462,1.71-0.188,2.75c0.883,2.175,3.001,1.77,4.563,1.125  c0.633,0.171,0.942-0.01,1.125-0.313c0.275-0.487,0.244-1.355,0.5-1.875c0.024-0.046,0.063-0.116,0.094-0.156  c0.032-0.038,0.087-0.094,0.125-0.125c0.193-0.143,0.479-0.191,0.906-0.094c1.327-1.11,1.905-2.257,2.5-3.656  c-0.611-0.056-0.952-0.128-1.094-0.219c-0.005-0.004-0.026-0.027-0.031-0.031c-0.008-0.008-0.025-0.023-0.031-0.031  c-0.002-0.004,0.002-0.027,0-0.031c0-0.004,0-0.026,0-0.031c0.001-0.004-0.001-0.026,0-0.031c0.011-0.017,0.044-0.045,0.063-0.063  c0.006-0.004,0.025-0.026,0.031-0.031c0.038-0.026,0.104-0.067,0.156-0.094c0.702-0.336,2.554-0.704,3.188-0.75  c2.875,0.349,2.456-1.723,4.594-2.75c0.514-0.417,0.702-0.732,0.688-0.969c-0.013-0.098-0.082-0.205-0.156-0.281  c-0.451-0.423-1.757-0.563-2.125-0.938c-0.011-0.012-0.022-0.05-0.031-0.063c-0.004-0.006-0.027-0.024-0.031-0.031  c-0.006-0.014-0.027-0.048-0.031-0.063c-0.003-0.021-0.002-0.07,0-0.094c0.018-0.104,0.109-0.234,0.25-0.375  c0.781-1.426,2.604-2.216,4.25-2.031c1.905,1.676,4.785-0.969,5.719-2.281c1.314,0.498,2.422,0.48,3.156-0.188  c0.055-0.051,0.138-0.128,0.188-0.188c0.186-0.223,0.346-0.513,0.469-0.844c1.119-1.046,4.991-1.3,3.469-3.188  c-0.233-0.273-0.337-0.499-0.344-0.656c0-0.004,0-0.026,0-0.031c0.001-0.004,0.031-0.026,0.031-0.031  c0.001-0.004-0.001-0.027,0-0.031c0.002-0.004-0.001-0.027,0-0.031c0.004-0.007,0.027-0.024,0.031-0.031  c0.002-0.003-0.002-0.028,0-0.031c0.027-0.033,0.082-0.071,0.125-0.094c0.739-0.337,3.414,0.729,3.281,2.313  c-0.005,0.054-0.02,0.134-0.031,0.188c-0.011,0.046-0.047,0.11-0.063,0.156c1.812-0.402,3.485,1.947,5.031,0.969  c-0.424-0.844-0.417-1.922,0.188-2.531c0.403-0.388,1.08-0.612,2.031-0.438c0.465-0.045,0.708-0.189,0.813-0.406  c0.381-0.907-1.564-2.98-0.813-4.031c-0.128-0.557-0.035-0.921,0.156-1.156c0.478-0.538,1.609-0.41,2.125-0.625  c0.137-0.062,0.231-0.173,0.25-0.313c0.013-0.171-0.082-0.435-0.313-0.781c-0.613-1.244-0.028-2.96-1.094-4.344  c-0.248-0.72-0.105-1.21,0.219-1.563c0.726-0.752,2.323-0.963,2.719-1.844c0.071-0.086,0.151-0.14,0.219-0.188  c0.034-0.021,0.092-0.049,0.125-0.063c0.033-0.011,0.093-0.027,0.125-0.031c0.024-0.001,0.07-0.003,0.094,0  c0.032,0.006,0.094,0.02,0.125,0.031c0.088,0.038,0.194,0.111,0.281,0.188c0.701,0.639,1.471,2.323,2.906,1.906  C1720.367,262.415,1722.796,261.889,1724.885,261.687z"
            />
            <path
                id="Wien"
                fill="#B1D1A3"
                stroke="#284566"
                stroke-width="2"
                d="M1725.108,261.843c-2.131,0.188-4.693,0.673-5.899,2.6  c-2.089,0.606-2.729-3.203-3.871-1.829c-0.582,1.295-3.74,1.089-2.945,3.392c1.065,1.383,0.502,3.109,1.116,4.354  c1.477,2.219-2.86,0.133-2.229,2.873c-0.943,1.318,2.369,4.215-0.011,4.445c-2.437-0.447-2.929,1.539-2.224,2.941  c-1.547,0.978-3.196-1.363-5.008-0.96c0.804-2.369-4.79-3.773-3.029-1.716c1.521,1.888-2.361,2.145-3.48,3.19  c-0.604,1.63-2.007,1.906-3.815,1.221c-0.935,1.313-3.813,3.94-5.718,2.265c-1.646-0.186-3.478,0.618-4.26,2.045  c-1.386,1.379,3.962,0.76,1.437,2.814c-2.138,1.027-1.712,3.109-4.587,2.761c-1.068,0.076-5.536,1.007-2.276,1.304  c-0.596,1.399-1.165,2.527-2.492,3.638c-2.279-0.521-0.46,3.186-2.772,2.563c-1.562,0.645-3.652,1.075-4.535-1.1  c1.138-1.823,0.354-3.578-1.718-3.63c-1.976-2.17-3.917-4.352-6.614-5.622c-1.831-1.978-1.793,1.498-2.66,2.554  c-0.64,1.804-1.898,3.176-2.261,5.007c-0.585,2.325-1.176,5.433,1.2,7.038c0.252,1.167-1.82,0.921-2.928,2.493  c-3.775,2.14,3.009-0.33,3.181,1.86c-2.949-0.181-0.633,5.358,1.399,4.1c2.686,0.836,0.887,1.989-0.5,3.4  c1.751,1.411,0.803,2.867,0.135,4.637c-0.323,1.522-0.076,3.814-1.458,4.634c-0.681,1.322-2.372,2.387-3.231,3.542  c-0.113,2.192-3.732,4,1.155,4.387c2.921,1.104,0.237,7.438,3.74,5.626c2.108,0.346,4.229,0.598,6.359,0.774  c-0.11,2.152-6.329,0.558-3.686,3.268c0.304,1.953,2.505,3.022,2.485,4.933c1.685-0.364,3.402-0.516,5.101-0.8  c0.946,1.661-0.104,2.792-2.091,3.228c-1.619,0.785-3.907,0.374-4.81,2.272c1.534,1.143,3.394-0.203,4.938-1.033  c2.939-2.949,7.459,0.403,10.252-2.094c2.88-2.732,5.631,2.215,7.52,0.896c1.831,0.447,3.883-0.01,3.391,2.631  c0.985,0.809,3.635,4.188,3.822,1.677c0.178-3.124,1.8-0.305,2.188-2.773c0.73-1.495,1.109-4.02,2.291-4.803  c2.549,1.126,5.427,1.42,7.916,2.564c2.405,1.735,5.606,1.743,8.384,2.635c2.629-0.44,4.486,1.764,7.042,1.951  c1.56,0.891,2.329,3.224,3.473,0.678c2.158,1.049,2.728-2.319,4.729-0.39c3.184,1.229,1.918-0.379,1.531-2.484  c0.573-1.585-1.732-4.44,0.043-5.156c3.286,0.015,6.473,0.522,8.349-2.456c1.678-1.014,2.221-2.893,3.942-4.002  c1.096-1.865,1.524-2.887,3.951-1.65c1.464-1.433,2.398-1.289,4.239-0.689c1.984-0.724,4.349-1.846,6.134-0.052  c3.508,1.623,4.943,6.156,8.975,6.826c3.143,0.384,10.043,5.783,8.092-0.875c0.97-1.32,0.467-3.809-0.959-4.947  c1.219-1.146,1.156-4.129-1.103-3.75c-1.71,0.861-3.001,1.991-3.551-0.051c-1.026,2.456-2.554-0.451-2.554-1.234  c-3.018-1.612,2.186-4.753-1.334-5.018c1.108,1.841-2.408,3.307-2.8,1.101c-0.513-1.845,1.409-3.481,0.399-4.801  c0.829-1.905,1.039-3.818,0.144-5.743c-0.701-1.868-0.293-3.603,0.796-5.218c0.95-1.931,1.983-3.84,1.711-6.051  c0.387-2.719,0.792-5.434,1.85-7.988c-1.896,0.094-1.936-1.824-4.2-1.699c0.632-3.108,1.971-6.029,2.301-9.2  c-1.815-0.763-3.435,0.116-5.121,0.279c-2.387,0.279-2.893-1.936-4.879-2.579c0.085-1.953-2.78-2.478-1.02-4.471  c0.667-1.526,2.6-3.511,0.066-4.432c-2.632-1.629-5.697-2.662-8.825-2.298c-0.636,1.312,0.529,3.495,0.474,5.169  c0.285,1.438-1.043,4.8-2.566,2.591c-3.495-2.62-7.054-5.152-10.629-7.66c-0.298-2.525,0.73-5.383-0.801-7.6  c-0.042-1.895,0.224-3.974-2.018-4.663C1727.015,262.852,1726.031,262.393,1725.108,261.843z"
            />
            <path
                id="outline"
                sodipodi:nodetypes="ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccsccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccsccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc"
                fill="none"
                stroke="#284566"
                stroke-width="3"
                d="  M199.479,744.464l7.891-3.452l7.461,1.492l10.943-4.477l6.964-6.964h6.963l14.426-18.404l-2.487-3.481l6.964-7.462l4.974,0.498  l0.995-7.462l10.943-13.43l-2.487-19.399l-8.953-4.974l2.984-5.97l-3.482-6.466l4.975-7.461l-6.467-7.959l13.431-3.979l0.497,4.477  l-1.989,6.467l10.445,6.964h13.431l0.497-5.969l7.958-7.462l7.959,4.477l13.928-0.497l6.964,8.456l9.948-0.497l1.989,6.466h9.948  l17.41-6.964l8.953,7.959l-10.943,7.461l2.985,5.472l10.445-0.995l17.409,22.384l-4.974,6.964l11.44,6.467l10.943-2.984  l14.425,1.492l11.938-12.933l10.446-2.985l6.964-1.492l4.974,3.979l-5.472,8.954l8.456,1.492l7.462-5.97l1.492-5.969l11.44-10.445  l14.425,0.497l1.492-7.461l-5.969-1.492l12.933-15.918l14.923,3.482l16.414-1.989l6.964-7.959v-13.431l11.44-9.948l8.954,3.482  l26.362-2.487l16.415,2.984l1.989-7.959l37.307-9.948l6.466,2.487l3.482-2.487l28.353,3.482l10.943-2.487l-0.995-17.409  l-6.467-15.917l10.446-5.97l8.953-6.964l2.487,3.482l-5.472,7.461l3.979,9.451l17.409-5.969l9.948,2.984l16.912-4.477l4.975,10.942  l15.42,12.933l7.461-5.471l6.467,1.989l8.456-14.425l8.456,0.497l7.958-3.979l10.446,0.498l4.974-1.492l8.456,4.477l-0.497,7.958  l12.436,5.97l3.481,6.964l-6.467,0.994l-3.481,10.943l6.467,13.431h7.958l11.938,10.445l0.497,4.477l18.902,11.44l6.963-4.477  l5.472,6.964l3.482-7.959l6.466-2.486c0,0,3.482-8.456,0.995-8.456s-5.472-5.97-5.472-5.97l0.498-5.471l4.477-6.467l-4.477-4.975  l1.989-4.974h4.975l0.497-12.933l6.466-6.964l-5.969-10.943l-3.979-9.948l-10.942-10.943l-7.462,6.467H884.35l-3.481-4.975  l4.974-10.445l-0.497-10.943l7.461-8.456l8.954-18.901l-12.436-19.896l-11.44-16.912l-7.959-2.985l-3.481-3.979l-3.482-4.478v-6.963  l-1.989-6.964l-6.467-5.97l-12.436-7.461l-4.974-10.943l-3.482-12.933l4.975-2.487l6.964,0.995l-0.498-5.969l3.482-4.975  l7.959-3.979l0.994-6.466v-6.467l5.97-3.481h8.953l7.959-1.492l6.466-1.492l2.487-4.478l4.974-8.456l1.99-4.974l6.466-0.995h7.462  l3.979-2.487l2.984-2.984l5.472-0.497l4.974-4.477l8.456-3.979l19.399-0.497l5.969-1.99l10.943-7.959l7.461-8.456l6.964-7.461  l4.974-5.969l1.492-5.969l1.99-4.975l1.492-4.974v-7.462l-0.497-6.964v-5.969l1.492-5.969l4.974-7.461l-3.481-8.954l-2.487-6.964  v-5.471l4.975-3.979l6.963-2.984l7.462-1.99l6.466,4.477l3.979,3.979l5.969-1.989l3.482-0.498l4.477,3.482l7.959,0.497l1.989,3.979  l2.984,3.482l7.461,4.477l4.478,1.989l3.481-4.477l0.995-12.436l6.466-0.995l7.959-7.461v-7.959l5.969-6.963l-5.471-24.374  l3.979-5.969l-10.445-8.456l4.477-5.472l1.99-4.974l1.989-7.959l6.466,0.995l6.964,0.497l19.399,15.917l9.948,0.995l6.964,10.445  l6.964,4.478v5.969l-7.461,3.481v4.477l4.974,4.478l0.498,3.979l8.953,4.975l30.342,0.497l7.959,4.478l7.461,0.497l6.467,0.995  l6.467,1.989l7.461,4.975l7.461-7.959l5.472-6.467l5.969,0.498l4.478-9.948v-10.943l9.947-2.487l5.97,6.964l6.466,2.984l6.467,2.984  l4.975-4.974l4.974-3.979l4.477,2.487l1.492,5.969h7.959l2.487,7.959l7.461,0.497l3.481-11.938l-0.994-17.409l3.481-13.43  l15.42-16.415l2.487-18.404h14.425l12.933,1.989l5.472,2.984h2.984l2.984-6.466l-3.481-6.467l-1.989-6.466l2.984-9.451l0.497-5.969  l-0.995-6.467l1.99-7.959l1.492-7.461l-5.472-22.881l2.984-7.959l0.995-8.456l17.906,0.995l3.979,3.979h17.409l6.467,9.948  l-4.975,8.953l7.462,0.995l7.461-5.969l11.44,0.497l3.482-15.42l7.958,5.472l8.954-3.481l19.398,9.45h11.938l9.451,12.933  l14.425,2.985l12.436,1.492l8.456,4.477l5.969,3.979l2.487,3.481l17.906,1.492l2.487-4.974l0.995-3.482h13.43l27.855,14.425  l4.975,7.959l34.321,19.399h10.943l4.974-3.979l17.907,3.481l16.415-1.492h2.486l3.482,3.482l3.979-5.969h4.477l4.477,3.979  l10.943-7.958l7.958-22.384l9.948,2.487l7.462-4.975l18.404,9.948l10.445-4.974l7.461,6.964v8.456l1.99,6.466l4.975-2.487  l1.492-4.477l10.942,1.492l6.964,7.959h14.426l10.445-5.969l7.461,8.953l8.456,26.86l2.487,8.456v7.461l4.975,13.928l-6.965,11.938  l-5.969,10.942l-5.969,12.934l0.497,25.368l-3.481,4.477l2.984,8.953l12.933,6.964l1.989,8.953l5.473,6.964l1.989,2.985l7.461,1.989  v11.44l2.984,7.959l1.99,7.461l2.984,10.445l5.472,0.995l6.466,6.964l5.97,1.989h4.477l6.466,7.959l1.492,7.461l0.498,11.44  l2.487,11.441l14.425,0.497l3.979,4.974l-11.441,16.415l1.99,5.472l-2.487,8.456l0.995,15.42l-8.456,9.948l-11.44,2.487v2.984  l12.436,8.953l2.984,5.472l-2.487,5.472l0.497,4.477l5.472,5.97l-0.497,14.922l5.969,9.948l-14.425,0.498l-35.316,10.445  l-5.97-9.451l-5.969,17.41l-18.404-4.975l-6.467-3.481l-2.984-7.959l-3.979-2.487h-4.477l-1.493-3.481l-8.456,0.497l-7.958-5.969  l-7.959,3.979h-10.943l-2.486,5.472l3.481,8.953l-11.938,6.467l-4.975,8.455h-6.467l-4.974,7.462l17.409,6.964l6.964-2.487  l19.399,7.461l8.456-3.481l9.948,8.456l0.995,13.928l10.942,6.964l0.498,8.456l-5.472,4.477l-6.964,2.984l1.99,7.461l2.486,6.467  l-5.969,7.461l-16.415,15.42l-11.44,0.497l-5.969,6.964l-6.964-6.964h-4.477l-2.487,4.975l2.984,9.451l-1.492,13.927l6.964,1.493  l0.497,12.435l-3.979,6.964l0.497,9.451l-0.497,14.922l-3.482,5.472l3.482,7.462h3.979l2.985,5.472l-2.985,3.979l2.487,8.954  l8.954-6.467l6.466-0.497l3.482,4.477l-2.487,5.472l-2.984,1.989l-3.979,4.477l-4.477,4.975l5.472,9.451h7.461l-3.482,6.964  l-12.435,5.471l-1.492,5.472h8.456l6.963,1.99l2.487,3.481l-2.487,2.487l-9.45,0.497l-3.979-0.994l-4.477,3.481l-7.461-4.477  l-5.97,3.481l-6.466-1.989l-8.456,3.481h-3.979l-3.482-2.984l-0.994,5.97l-1.99,5.969l-4.974,4.974l-1.99,6.467l-1.989,4.477  l-8.953,0.995l-1.99,7.958l-4.974,6.467l-9.451,14.425l-9.451,2.487l-9.45,7.461l-7.959,5.472l-7.959,1.99l3.979,6.466v14.425  l1.492,12.934l4.477,6.964l5.97,0.994l0.994,5.969l4.477,3.979v12.933h-4.477l-10.445-13.43l-4.975,1.989l-27.357-10.942  l-14.923,3.979l-10.445,7.462l-8.456,1.989h-4.975l-5.969-3.481h-6.964l-2.984,8.953l-1.492,3.481l-7.958-2.984l-13.928,5.97v6.466  v7.461l-7.959,6.467l-11.44,1.492l-6.467-5.969l-4.974-4.975h-9.451l-24.871,3.482l-20.891,1.989l-10.446-3.979l-19.399,3.482  l-17.409,3.979l-5.472,10.942l-2.984,4.975l-9.948-10.445l-5.969,8.456l-14.425,1.492l-10.943,39.296l-20.395,4.477l-5.471,13.43  l-6.467,0.995l-4.477,7.461l-18.902,5.472v12.933l-4.477,7.462l-14.425-13.431l-4.477,4.477l-6.964-2.984l-5.969-3.979l-5.97-6.466  l-18.404,3.979l-9.948,3.481l-6.964-3.481l-15.917,2.486l-16.912,2.487l-10.943-15.917l-16.414-1.99l-14.923,0.995l-18.404-12.436  l-16.912,0.498l-11.938,6.964l-21.886-1.99l-25.865-9.451l-8.456,4.975l-7.959-7.461l-7.959,1.989l-7.461-5.969l-13.928,4.477  l-8.953-5.969l-21.887,8.456l-19.896,0.994l-21.389-10.942l-22.881-1.492l-27.357-1.492l-25.369,0.497l-21.389-11.44l-4.974-2.487  l-15.42,0.497l-23.876-1.492l-11.938-1.492l-34.818-15.917l-10.943-6.467c0,0-4.477-19.896-6.467-20.394  c-1.989-0.497-9.948,0.497-9.948,0.497l-9.948-3.979l3.979-19.398l-8.456-15.42l-3.481-3.482l-10.446,0.995l-14.922-9.451  l-0.995-7.461l-7.461-10.943v-18.404l15.917-3.979l8.953-17.409l-7.958-6.467l-24.871,5.472l-7.959,8.954l-28.85,7.461  l-29.348,16.912l-14.922,1.492l-0.995,6.467h-9.451l-5.472-5.472l-25.368-7.462l-18.901,7.959l-8.456-7.461h-5.969l-10.943,14.425  l-9.948,2.487l-6.467-4.477l-11.44-1.99l-19.399,6.467l-18.404,1.492l-19.896,23.378l1.492,12.934l-6.466,6.466v14.425l-9.451,8.456  l-2.984,10.943l-15.42-3.481l-18.901,4.477l-7.462-4.975l-10.943-0.994l-4.974-5.97l-7.461,3.482l-6.467-1.492l6.964-8.954  l-1.492-5.969l-11.44-2.984l-7.461-7.461l-13.928-0.498l-14.923,7.462l-16.912-0.995l-9.948-6.964l-1.492-5.472l5.969-15.42  l-12.933-10.445l-1.492-6.467l-11.44-7.461l-4.477,1.492l-3.979-0.497l-5.472,14.922l-5.969,4.975l1.492,5.969l-3.979,1.492  l-13.43-2.487l-2.984,10.446l-0.498,9.948l-10.445,2.984l-8.953,6.964l-11.919-0.198l-6.486-5.273l-7.958-0.497l-0.498-4.478  l-10.942-9.45h-5.472l-4.975-3.979l-10.942,0.995l-5.97-9.451l-5.969-0.995l-0.497-9.948v-4.477l3.979-7.461l-6.467-9.948  l-10.943-0.498l-9.45-5.472h-7.959l-19.896-9.948l-8.456,1.99l-8.954-1.492l4.975-13.431l-0.497-9.451l-1.492-6.466l-6.964-8.456  l-4.478-4.477l0.995-13.928l-6.964-7.959l3.482-5.472l-8.954-8.456l6.964-11.938l7.462-8.953l6.466-14.923l6.964-0.995l8.456-2.984  v-8.456l-7.461-8.953l2.984-11.938l-13.928-4.477l-7.461-8.953l-2.487-4.975l3.481-11.44l10.943,0.995l26.86-1.492l5.969-10.943  l4.478-10.445l10.942-0.498l4.478,5.472l-0.498,9.451l9.948,5.969l5.969-4.974l5.472,6.964l11.44-5.472l2.985,7.461l7.958,5.472  v8.456l2.487,3.481l6.964-4.974h3.979v7.461l7.461,2.487l3.979,5.472l1.492,9.45l-8.456,5.472l5.472,4.477l0.995,14.426l5.471-5.97  l9.451,1.493l6.467-8.457l10.942,2.985l2.487,7.958l-5.969,10.943l1.989,8.456l-1.989,4.975l-6.467,1.492l-3.481,4.477v5.472  L199.479,744.464z"
            />
        </svg>`;
    }

    highlight(text: string, highlights: string[]) {
        const escapeRegExp = (string: string) => string.replace(/[.*+?^${}()|[\]\\]/g, "\\$&");
        for (const highlight of highlights) {
            text = text.replaceAll(
                new RegExp(escapeRegExp(highlight), "gi"),
                /*html*/ `<span class="bg-red-500 p-[2px] text-[#fff] italic">$&</span>`
            );
        }
        return text;
    }
}

export interface PreparedQuery {
    tokens: string[];
    must: Set<string>;
    mustNot: Set<string>;
    optional: Set<string>;
}

export function prepareQuery(query: string): PreparedQuery {
    query = query.trim();
    if (query.length == 0)
        return {
            tokens: [],
            must: new Set<string>(),
            mustNot: new Set<string>(),
            optional: new Set<string>(),
        };
    const regex = /\+?"[^"]+"|-"[^"]+"|\S+/g;
    const rawTokens = query.match(regex) || [];
    const tokens = rawTokens.map((token) => (token.startsWith('"') && token.endsWith('"') ? token.substring(1, token.length - 1) : token));

    const preparedQuery = {
        tokens,
        must: new Set<string>(),
        mustNot: new Set<string>(),
        optional: new Set<string>(),
    };
    for (let token of preparedQuery.tokens) {
        token = token.toLowerCase();

        if (token.startsWith("+") && token.length >= 2) {
            let finalToken = token.substring(1);
            finalToken = finalToken.startsWith('"') && finalToken.endsWith('"') ? finalToken.substring(1, finalToken.length - 1) : finalToken;
            preparedQuery.must.add(finalToken);
        } else if (token.startsWith("-") && token.length >= 2) {
            let finalToken = token.substring(1);
            finalToken = finalToken.startsWith('"') && finalToken.endsWith('"') ? finalToken.substring(1, finalToken.length - 1) : finalToken;
            preparedQuery.mustNot.add(finalToken);
        } else if (token.length >= 2) {
            let finalToken = token;
            finalToken = finalToken.startsWith('"') && finalToken.endsWith('"') ? finalToken.substring(1, finalToken.length - 1) : finalToken;
            preparedQuery.optional.add(finalToken);
        }
    }
    return preparedQuery;
}

export function matchesQuery(query: PreparedQuery, text: string, lowerCase = true) {
    const { mustNot, must, optional } = query;
    if (lowerCase) text = text.toLowerCase();
    if (mustNot.size > 0 && Array.from(mustNot.values()).some((token) => text.includes(token))) return false;
    if (must.size > 0 && Array.from(must.values()).every((token) => text.includes(token))) return true;
    if (optional.size > 0 && Array.from(optional.values()).some((token) => text.includes(token))) return true;
    return false;
}
